GSC_faction_window_switch = {
	ROOT = {
		if = {
			limit = {
				has_country_flag = GSC_faction_window_flag
			}
			clr_country_flag = GSC_faction_window_flag
		}
		else = {
			set_country_flag = GSC_faction_window_flag
		}
	}
	KIV_GSC_faction_array = yes
}

KIV_GSC_faction_array = {
	clear_array = global.GSC_faction_array
	if = {
		limit = {
			has_global_flag = KIV_GSC_faction_collapse_flag
			KIV = {
				is_faction_leader = yes
			}
		}
		every_possible_country = {
			limit = {
				OR = {
					tag = KIV
					tag = VPA
					tag = AFY
					tag = SSH
					tag = HGN
					tag = SCS
					tag = MSY
					tag = GEH
					tag = AHS
					tag = CHG
					tag = HRA
					tag = KRS
					tag = ODY
					is_ally_with = KIV
				}
			}
			add_to_array = {
				global.GSC_faction_array = THIS
			}
			add_dynamic_modifier = {
				modifier = KIV_campus_city_modifier
			}
			add_ideas = KIV_hailand_railway_academy_engineering_department
			add_ideas = KIV_food_research_association
		}
		get_sorted_scored_countries = {
			scorer = IRIS_GSC_faction_array
			array = global.GSC_faction_array
		}
		#生活消费品
		set_variable = {
			global.GSC_MODIFIER_CONSUMER_GOODS_FACTOR_VAR = global.GSC_faction_array^num
		}
		multiply_variable = {
			global.GSC_MODIFIER_CONSUMER_GOODS_FACTOR_VAR = -0.75
		}
		multiply_variable = {
			global.GSC_MODIFIER_CONSUMER_GOODS_FACTOR_VAR = 0.01
		}
		#科研
		set_variable = {
			global.GSC_MODIFIER_RESEARCH_SPEED_FACTOR_VAR = global.GSC_faction_array^num
		}
		multiply_variable = {
			global.GSC_MODIFIER_RESEARCH_SPEED_FACTOR_VAR = 0.6
		}
		multiply_variable = {
			global.GSC_MODIFIER_RESEARCH_SPEED_FACTOR_VAR = 0.01
		}
	}
}
